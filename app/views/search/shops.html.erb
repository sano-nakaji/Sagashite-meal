<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
if(navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(function(position) {
    var latitude = position.coords.latitude;
    console.log('緯度：');
    console.log(latitude);
    var longitude = position.coords.longitude;
    console.log('経度：');
    console.log(longitude);
    $.ajax({
      url: "shops",
      type: "GET",
      data: {
        latitude: latitude,
        longitude: longitude,
      },
      dataType: "json",
      success: function(response) {
        console.log(response); // サーバーから返された店舗情報を確認
        console.log('success')
        // サーバーから返された店舗情報をHTMLに反映
        var shopsHtml = "";
        console.log(response)
         response.forEach(function(shop) {
           shopsHtml += "<div><h2>" + shop.name + "</h2>";
           shopsHtml += "<p>" + shop.address + "</p>";
           // shopsHtml += "<p>" + shop.tel + "</p></div>";
         });
         $("#shops-list").html(shopsHtml);
      },
      error: function(error) {
        console.log(error); // エラーが発生した場合はコンソールにログを出力
      }
    });
  });
}
</script>

<h1>お店の検索結果</h1>

<p>現在の緯度: <%= @latitude %></p>
<p>現在の経度: <%= @longitude %></p>

<div id="shops-list">
  <% @shops.each do |shop| %>
    <div>
      <h4><%= shop['name'] %></h4>
      <p><%= shop['address'] %></p>
      <p><%= shop['tel'] %></p>
    </div>
  <% end %>
</div>
